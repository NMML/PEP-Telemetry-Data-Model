<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.StoredProcedureOraclev10g" name="UPDATEHISTOS" id="B69837F7-D341-4F14-D7B2-622454B59A86" directorySegmentName="seg_0">
<sourceConnName>raja_peptel</sourceConnName>
<sourceObjSchema>PEPTEL</sourceObjSchema>
<sourceObjName>UPDATEHISTOS</sourceObjName>
<createdBy>Josh.London@afsc.noaa.gov</createdBy>
<createdTime>2013-03-26 18:25:14 UTC</createdTime>
<ownerDesignName>peptel</ownerDesignName>
<owner>BF8C4EB8-E0B5-DDD1-2DE6-51EAEB1030C9</owner>
<source>CREATE OR REPLACE PROCEDURE PEPTEL.UPDATEHISTOS&lt;br/&gt;authid current_user&lt;br/&gt;IS&lt;br/&gt;  C NUMBER;&lt;br/&gt;BEGIN&lt;br/&gt;  execute immediate &apos;set role ALL&apos;;&lt;br/&gt;  SELECT COUNT(*) INTO C&lt;br/&gt;  FROM USER_SEQUENCES&lt;br/&gt;  WHERE SEQUENCE_NAME = &apos;HIST_SEQ&apos;;&lt;br/&gt;&lt;br/&gt;  IF (C = 0) THEN&lt;br/&gt;    EXECUTE IMMEDIATE &apos;CREATE SEQUENCE HIST_SEQ START WITH 1 INCREMENT BY 1 MINVALUE 0&apos;;&lt;br/&gt;    ELSE&lt;br/&gt;    EXECUTE IMMEDIATE &apos;DROP SEQUENCE HIST_SEQ&apos;; &lt;br/&gt;    EXECUTE IMMEDIATE &apos;CREATE SEQUENCE HIST_SEQ START WITH 1 INCREMENT BY 1 MINVALUE 0&apos;;&lt;br/&gt;  END IF;&lt;br/&gt;  EXECUTE IMMEDIATE &apos;TRUNCATE TABLE PEPTEL.HISTOS&apos;;&lt;br/&gt;  commit;&lt;br/&gt;  EXECUTE IMMEDIATE &apos;&lt;br/&gt;  INSERT INTO PEPTEL.HISTOS&lt;br/&gt;    SELECT &lt;br/&gt;    NULL AS HISTID,&lt;br/&gt;    PEPDEPLOYMENTS.DEPLOYID,&lt;br/&gt;    PEPCAPTUREDATA.SPENO,&lt;br/&gt;    PEPTAGINFO.PTT,&lt;br/&gt;    PEPCAPTUREDATA.PROJECTID,&lt;br/&gt;    PEPCAPTUREDATA.SPECIES,&lt;br/&gt;    PEPDEPLOYMENTS.DEPLOYDATE,&lt;br/&gt;    PEPTAGINFO.TAGTYPE,&lt;br/&gt;    PEPCAPTUREDATA.AGE,&lt;br/&gt;    PEPCAPTUREDATA.SEX,&lt;br/&gt;    TO_DATE(EXTHISTOS.DATETIME,&apos;&apos;YYYY-MM-DD HH24:MI:SS&apos;&apos;) DATADATETIME,&lt;br/&gt;    TO_CHAR(TO_DATE(EXTHISTOS.DATETIME,&apos;&apos;YYYY-MM-DD HH24:MI:SS&apos;&apos;),&apos;&apos;YYYY-MM-DD HH24&apos;&apos;) DATAHOUR,&lt;br/&gt;    EXTHISTOS.HISTTYPE,&lt;br/&gt;    EXTHISTOS.DEPTHSENSOR,&lt;br/&gt;    EXTHISTOS.DATASOURCE,&lt;br/&gt;    EXTHISTOS.TIMEOFFSET,&lt;br/&gt;    EXTHISTOS.MSGCOUNT,&lt;br/&gt;    EXTHISTOS.NUMBINS,&lt;br/&gt;    EXTHISTOS.BINSUM,&lt;br/&gt;    EXTHISTOS.BIN1, &lt;br/&gt;	EXTHISTOS.BIN2, &lt;br/&gt;	EXTHISTOS.BIN3, &lt;br/&gt;	EXTHISTOS.BIN4, &lt;br/&gt;	EXTHISTOS.BIN5, &lt;br/&gt;	EXTHISTOS.BIN6, &lt;br/&gt;	EXTHISTOS.BIN7, &lt;br/&gt;	EXTHISTOS.BIN8, &lt;br/&gt;	EXTHISTOS.BIN9, &lt;br/&gt;	EXTHISTOS.BIN10, &lt;br/&gt;	EXTHISTOS.BIN11, &lt;br/&gt;	EXTHISTOS.BIN12, &lt;br/&gt;	EXTHISTOS.BIN13, &lt;br/&gt;	EXTHISTOS.BIN14, &lt;br/&gt;	EXTHISTOS.BIN15, &lt;br/&gt;	EXTHISTOS.BIN16, &lt;br/&gt;	EXTHISTOS.BIN17, &lt;br/&gt;	EXTHISTOS.BIN18, &lt;br/&gt;	EXTHISTOS.BIN19, &lt;br/&gt;	EXTHISTOS.BIN20, &lt;br/&gt;	EXTHISTOS.BIN21, &lt;br/&gt;	EXTHISTOS.BIN22, &lt;br/&gt;	EXTHISTOS.BIN23, &lt;br/&gt;	EXTHISTOS.BIN24, &lt;br/&gt;	EXTHISTOS.BIN25, &lt;br/&gt;	EXTHISTOS.BIN26, &lt;br/&gt;	EXTHISTOS.BIN27, &lt;br/&gt;	EXTHISTOS.BIN28, &lt;br/&gt;	EXTHISTOS.BIN29, &lt;br/&gt;	EXTHISTOS.BIN30, &lt;br/&gt;	EXTHISTOS.BIN31, &lt;br/&gt;	EXTHISTOS.BIN32, &lt;br/&gt;	EXTHISTOS.BIN33, &lt;br/&gt;	EXTHISTOS.BIN34, &lt;br/&gt;	EXTHISTOS.BIN35, &lt;br/&gt;	EXTHISTOS.BIN36, &lt;br/&gt;	EXTHISTOS.BIN37, &lt;br/&gt;	EXTHISTOS.BIN38, &lt;br/&gt;	EXTHISTOS.BIN39, &lt;br/&gt;	EXTHISTOS.BIN40, &lt;br/&gt;	EXTHISTOS.BIN41, &lt;br/&gt;	EXTHISTOS.BIN42, &lt;br/&gt;	EXTHISTOS.BIN43, &lt;br/&gt;	EXTHISTOS.BIN44, &lt;br/&gt;	EXTHISTOS.BIN45, &lt;br/&gt;	EXTHISTOS.BIN46, &lt;br/&gt;	EXTHISTOS.BIN47, &lt;br/&gt;	EXTHISTOS.BIN48, &lt;br/&gt;	EXTHISTOS.BIN49, &lt;br/&gt;	EXTHISTOS.BIN50, &lt;br/&gt;	EXTHISTOS.BIN51, &lt;br/&gt;	EXTHISTOS.BIN52, &lt;br/&gt;	EXTHISTOS.BIN53, &lt;br/&gt;	EXTHISTOS.BIN54, &lt;br/&gt;	EXTHISTOS.BIN55, &lt;br/&gt;	EXTHISTOS.BIN56, &lt;br/&gt;	EXTHISTOS.BIN57, &lt;br/&gt;	EXTHISTOS.BIN58, &lt;br/&gt;	EXTHISTOS.BIN59, &lt;br/&gt;	EXTHISTOS.BIN60, &lt;br/&gt;	EXTHISTOS.BIN61, &lt;br/&gt;	EXTHISTOS.BIN62, &lt;br/&gt;	EXTHISTOS.BIN63, &lt;br/&gt;	EXTHISTOS.BIN64, &lt;br/&gt;	EXTHISTOS.BIN65, &lt;br/&gt;	EXTHISTOS.BIN66, &lt;br/&gt;	EXTHISTOS.BIN67, &lt;br/&gt;	EXTHISTOS.BIN68, &lt;br/&gt;	EXTHISTOS.BIN69, &lt;br/&gt;	EXTHISTOS.BIN70, &lt;br/&gt;	EXTHISTOS.BIN71, &lt;br/&gt;	EXTHISTOS.BIN72&lt;br/&gt;  FROM EXTHISTOS&lt;br/&gt;  LEFT JOIN PEPDEPLOYMENTS&lt;br/&gt;  ON PEPDEPLOYMENTS.DEPLOYID = EXTHISTOS.DEPLOYID&lt;br/&gt;  LEFT JOIN PEPCAPTUREDATA&lt;br/&gt;  ON PEPDEPLOYMENTS.SPENO = PEPCAPTUREDATA.SPENO&lt;br/&gt;  LEFT JOIN PEPTAGINFO&lt;br/&gt;  ON PEPDEPLOYMENTS.SERIALNUM = PEPTAGINFO.SERIALNUM&apos;;&lt;br/&gt;  COMMIT;&lt;br/&gt;  DBMS_MVIEW.REFRESH(&apos;DRYTIMES_20,DRYTIMES,TAD&apos;,&apos;C&apos;);&lt;br/&gt;END;</source>
<body>CREATE OR REPLACE PROCEDURE PEPTEL.UPDATEHISTOS&lt;br/&gt;authid current_user&lt;br/&gt;IS&lt;br/&gt;  C NUMBER;&lt;br/&gt;BEGIN&lt;br/&gt;  execute immediate &apos;set role ALL&apos;;&lt;br/&gt;  SELECT COUNT(*) INTO C&lt;br/&gt;  FROM USER_SEQUENCES&lt;br/&gt;  WHERE SEQUENCE_NAME = &apos;HIST_SEQ&apos;;&lt;br/&gt;&lt;br/&gt;  IF (C = 0) THEN&lt;br/&gt;    EXECUTE IMMEDIATE &apos;CREATE SEQUENCE HIST_SEQ START WITH 1 INCREMENT BY 1 MINVALUE 0&apos;;&lt;br/&gt;    ELSE&lt;br/&gt;    EXECUTE IMMEDIATE &apos;DROP SEQUENCE HIST_SEQ&apos;; &lt;br/&gt;    EXECUTE IMMEDIATE &apos;CREATE SEQUENCE HIST_SEQ START WITH 1 INCREMENT BY 1 MINVALUE 0&apos;;&lt;br/&gt;  END IF;&lt;br/&gt;  EXECUTE IMMEDIATE &apos;TRUNCATE TABLE PEPTEL.HISTOS&apos;;&lt;br/&gt;  commit;&lt;br/&gt;  EXECUTE IMMEDIATE &apos;&lt;br/&gt;  INSERT INTO PEPTEL.HISTOS&lt;br/&gt;    SELECT &lt;br/&gt;    NULL AS HISTID,&lt;br/&gt;    PEPDEPLOYMENTS.DEPLOYID,&lt;br/&gt;    PEPCAPTUREDATA.SPENO,&lt;br/&gt;    PEPTAGINFO.PTT,&lt;br/&gt;    PEPCAPTUREDATA.PROJECTID,&lt;br/&gt;    PEPCAPTUREDATA.SPECIES,&lt;br/&gt;    PEPDEPLOYMENTS.DEPLOYDATE,&lt;br/&gt;    PEPTAGINFO.TAGTYPE,&lt;br/&gt;    PEPCAPTUREDATA.AGE,&lt;br/&gt;    PEPCAPTUREDATA.SEX,&lt;br/&gt;    TO_DATE(EXTHISTOS.DATETIME,&apos;&apos;YYYY-MM-DD HH24:MI:SS&apos;&apos;) DATADATETIME,&lt;br/&gt;    TO_CHAR(TO_DATE(EXTHISTOS.DATETIME,&apos;&apos;YYYY-MM-DD HH24:MI:SS&apos;&apos;),&apos;&apos;YYYY-MM-DD HH24&apos;&apos;) DATAHOUR,&lt;br/&gt;    EXTHISTOS.HISTTYPE,&lt;br/&gt;    EXTHISTOS.DEPTHSENSOR,&lt;br/&gt;    EXTHISTOS.DATASOURCE,&lt;br/&gt;    EXTHISTOS.TIMEOFFSET,&lt;br/&gt;    EXTHISTOS.MSGCOUNT,&lt;br/&gt;    EXTHISTOS.NUMBINS,&lt;br/&gt;    EXTHISTOS.BINSUM,&lt;br/&gt;    EXTHISTOS.BIN1, &lt;br/&gt;	EXTHISTOS.BIN2, &lt;br/&gt;	EXTHISTOS.BIN3, &lt;br/&gt;	EXTHISTOS.BIN4, &lt;br/&gt;	EXTHISTOS.BIN5, &lt;br/&gt;	EXTHISTOS.BIN6, &lt;br/&gt;	EXTHISTOS.BIN7, &lt;br/&gt;	EXTHISTOS.BIN8, &lt;br/&gt;	EXTHISTOS.BIN9, &lt;br/&gt;	EXTHISTOS.BIN10, &lt;br/&gt;	EXTHISTOS.BIN11, &lt;br/&gt;	EXTHISTOS.BIN12, &lt;br/&gt;	EXTHISTOS.BIN13, &lt;br/&gt;	EXTHISTOS.BIN14, &lt;br/&gt;	EXTHISTOS.BIN15, &lt;br/&gt;	EXTHISTOS.BIN16, &lt;br/&gt;	EXTHISTOS.BIN17, &lt;br/&gt;	EXTHISTOS.BIN18, &lt;br/&gt;	EXTHISTOS.BIN19, &lt;br/&gt;	EXTHISTOS.BIN20, &lt;br/&gt;	EXTHISTOS.BIN21, &lt;br/&gt;	EXTHISTOS.BIN22, &lt;br/&gt;	EXTHISTOS.BIN23, &lt;br/&gt;	EXTHISTOS.BIN24, &lt;br/&gt;	EXTHISTOS.BIN25, &lt;br/&gt;	EXTHISTOS.BIN26, &lt;br/&gt;	EXTHISTOS.BIN27, &lt;br/&gt;	EXTHISTOS.BIN28, &lt;br/&gt;	EXTHISTOS.BIN29, &lt;br/&gt;	EXTHISTOS.BIN30, &lt;br/&gt;	EXTHISTOS.BIN31, &lt;br/&gt;	EXTHISTOS.BIN32, &lt;br/&gt;	EXTHISTOS.BIN33, &lt;br/&gt;	EXTHISTOS.BIN34, &lt;br/&gt;	EXTHISTOS.BIN35, &lt;br/&gt;	EXTHISTOS.BIN36, &lt;br/&gt;	EXTHISTOS.BIN37, &lt;br/&gt;	EXTHISTOS.BIN38, &lt;br/&gt;	EXTHISTOS.BIN39, &lt;br/&gt;	EXTHISTOS.BIN40, &lt;br/&gt;	EXTHISTOS.BIN41, &lt;br/&gt;	EXTHISTOS.BIN42, &lt;br/&gt;	EXTHISTOS.BIN43, &lt;br/&gt;	EXTHISTOS.BIN44, &lt;br/&gt;	EXTHISTOS.BIN45, &lt;br/&gt;	EXTHISTOS.BIN46, &lt;br/&gt;	EXTHISTOS.BIN47, &lt;br/&gt;	EXTHISTOS.BIN48, &lt;br/&gt;	EXTHISTOS.BIN49, &lt;br/&gt;	EXTHISTOS.BIN50, &lt;br/&gt;	EXTHISTOS.BIN51, &lt;br/&gt;	EXTHISTOS.BIN52, &lt;br/&gt;	EXTHISTOS.BIN53, &lt;br/&gt;	EXTHISTOS.BIN54, &lt;br/&gt;	EXTHISTOS.BIN55, &lt;br/&gt;	EXTHISTOS.BIN56, &lt;br/&gt;	EXTHISTOS.BIN57, &lt;br/&gt;	EXTHISTOS.BIN58, &lt;br/&gt;	EXTHISTOS.BIN59, &lt;br/&gt;	EXTHISTOS.BIN60, &lt;br/&gt;	EXTHISTOS.BIN61, &lt;br/&gt;	EXTHISTOS.BIN62, &lt;br/&gt;	EXTHISTOS.BIN63, &lt;br/&gt;	EXTHISTOS.BIN64, &lt;br/&gt;	EXTHISTOS.BIN65, &lt;br/&gt;	EXTHISTOS.BIN66, &lt;br/&gt;	EXTHISTOS.BIN67, &lt;br/&gt;	EXTHISTOS.BIN68, &lt;br/&gt;	EXTHISTOS.BIN69, &lt;br/&gt;	EXTHISTOS.BIN70, &lt;br/&gt;	EXTHISTOS.BIN71, &lt;br/&gt;	EXTHISTOS.BIN72&lt;br/&gt;  FROM EXTHISTOS&lt;br/&gt;  LEFT JOIN PEPDEPLOYMENTS&lt;br/&gt;  ON PEPDEPLOYMENTS.DEPLOYID = EXTHISTOS.DEPLOYID&lt;br/&gt;  LEFT JOIN PEPCAPTUREDATA&lt;br/&gt;  ON PEPDEPLOYMENTS.SPENO = PEPCAPTUREDATA.SPENO&lt;br/&gt;  LEFT JOIN PEPTAGINFO&lt;br/&gt;  ON PEPDEPLOYMENTS.SERIALNUM = PEPTAGINFO.SERIALNUM&apos;;&lt;br/&gt;  COMMIT;&lt;br/&gt;  DBMS_MVIEW.REFRESH(&apos;DRYTIMES_20,DRYTIMES,TAD&apos;,&apos;C&apos;);&lt;br/&gt;END;</body>
</StoredProcedureOraclev10g>